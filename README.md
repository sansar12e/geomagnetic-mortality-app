# Geomagnetic Storms & Health Outcomes Explorer

Interactive data visualization application exploring statistical relationships between geomagnetic storm activity and health outcomes in the United States (2018-2025).

---

## Overview

This Streamlit application analyzes weekly correlations between geomagnetic indices (Kp, ap) and four health outcomes to test whether magnetic activity correlates specifically with mental health or shows broader patterns.

### Health Outcomes Analyzed

1. **Suicide (ICD-10: X60-X84)** - Intentional self-harm
2. **Violence/Assault (ICD-10: X85-Y09)** - Homicide and assault  
3. **Overdose (ICD-10: X40-X49 + Y10-Y19)** - Acute poisoning (accidental + undetermined)
4. **Cardiovascular (ICD-10: I20-I25 + I60-I69)** - Heart attacks and strokes

### Key Findings

**Correlations with magnetic storm activity:**
- **Suicide**: Positive correlation (r â‰ˆ 0.23 same-week, r â‰ˆ 0.19 lag-1, p < 0.001)
  - Lagged effects (storms 1 week prior) are biologically plausible
- **Violence**: Negative correlation (r â‰ˆ -0.16, p < 0.01)
- **Cardiovascular**: Negative correlation (r â‰ˆ -0.16, p < 0.01)  
- **Overdose**: No significant correlation (r â‰ˆ 0.04, p > 0.05)

**Interpretation:**  
Mixed results suggest outcome-specific mechanisms rather than simple universal effects. Suicide shows the most consistent pattern, potentially via circadian/melatonin disruption pathways. Inverse correlations for violence and cardiovascular may reflect behavioral changes or weather confounding.

---

## Data Sources

**Mortality Data:**  
CDC WONDER Provisional Mortality Statistics (2018-2025)  
[https://wonder.cdc.gov/controller/datarequest/D176](https://wonder.cdc.gov/controller/datarequest/D176)

**Geomagnetic Data:**  
GFZ German Research Centre for Geosciences - Kp and ap indices (3-hour resolution)  
[https://kp.gfz.de/app/files/Kp_ap_since_1932.txt](https://kp.gfz.de/app/files/Kp_ap_since_1932.txt)

---

## Installation & Setup

### Prerequisites
- Python 3.11+
- Poetry

### Installation

```bash
# Navigate to project directory
cd /path/to/sun

# Install dependencies
poetry install

# Preprocess data (first time only)
poetry run python preprocess_data.py
```

### Running the Application

```bash
# Option 1: Using run script
./run.sh

# Option 2: Direct command
poetry run streamlit run streamlit_app.py
```

Application opens at `http://localhost:8501`

---

## Project Structure

```
sun/
â”œâ”€â”€ streamlit_app.py              # Landing page
â”œâ”€â”€ pages/                        # Multi-page app
â”‚   â”œâ”€â”€ 1_ðŸ“Š_Overview.py          # Summary statistics
â”‚   â”œâ”€â”€ 2_ðŸ”¬_Deep_Dive.py         # Detailed visualizations
â”‚   â”œâ”€â”€ 3_ðŸ§ª_Interactive_Explorer.py  # Custom analysis
â”‚   â””â”€â”€ 4_ðŸ“š_Methodology.py       # Methods and limitations
â”œâ”€â”€ components/                   # Reusable UI components
â”‚   â”œâ”€â”€ charts.py                 # Plotly visualizations
â”‚   â”œâ”€â”€ statistics.py             # Statistical calculations
â”‚   â””â”€â”€ explanations.py           # Text explanations
â”œâ”€â”€ utils/                        # Data utilities
â”‚   â”œâ”€â”€ data_loader.py            # Load preprocessed data
â”‚   â””â”€â”€ mmwr_calendar.py          # CDC week calculations
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                      # Original data files
â”‚   â”‚   â”œâ”€â”€ Kp_ap_since_1932.txt
â”‚   â”‚   â””â”€â”€ [4 mortality .xls files]
â”‚   â””â”€â”€ preprocessed/             # Generated by preprocess_data.py
â”‚       â”œâ”€â”€ weekly_merged.parquet
â”‚       â”œâ”€â”€ monthly_summary.parquet
â”‚       â”œâ”€â”€ correlation_matrix.parquet
â”‚       â””â”€â”€ summary_stats.json
â”œâ”€â”€ preprocess_data.py            # Data preprocessing pipeline
â”œâ”€â”€ pyproject.toml                # Dependencies
â””â”€â”€ README.md
```

---

## Methodology Summary

### Data Processing
1. **Geomagnetic data**: 3-hour Kp/ap measurements aggregated to weekly means, maxima, and storm counts
2. **Mortality data**: CDC MMWR week-aligned death counts for 4 outcomes
3. **Temporal alignment**: Both datasets merged on MMWR epidemiological weeks
4. **Lagged variables**: 1-week prior geomagnetic metrics to test delayed effects

### Statistical Analysis
- **Correlation**: Pearson (linear) and Spearman (rank-based) correlations
- **Significance testing**: Two-tailed t-tests, p < 0.05 threshold
- **Effect sizes**: Cohen's d for group comparisons (storm vs quiet weeks)
- **Seasonal adjustment**: Monthly detrending to isolate week-to-week variation
- **Time period**: 388 weeks (January 2018 - June 2025)

### Storm Definitions
- **Quiet week**: Mean Kp â‰¤ 2.0
- **Storm week**: Mean Kp â‰¥ 3.5
- **Storm events**: Count of 3-hour intervals with Kp â‰¥ 5

---

## Important Limitations

**This is an exploratory ecological study. Correlations do not establish causation.**

### Key Caveats
1. **Ecological fallacy**: Population-level correlations do not apply to individuals
2. **Temporal resolution**: Weekly bins may obscure acute effects; daily data would be preferable
3. **Confounding**: Weather, seasons, holidays, and trends not fully controlled
4. **Small effect sizes**: Magnetic activity explains â‰¤5% of variance in deaths
5. **Mixed results**: Inverse correlations for some outcomes challenge simple interpretations
6. **Year effects**: Geomagnetic activity correlates with year due to solar cycle (2018-2025 = solar minimum â†’ maximum), which can absorb real effects in regression models

### Collinearity Issue
Controlling for year fixed effects may be overly conservative given the 11-year solar cycle. Our analysis primarily uses month-level controls to preserve potential geomagnetic signals.

---

## Application Features

### 1. Landing Page
- Multi-outcome comparison summary
- Key finding highlights
- Scientific interpretation of mixed results

### 2. Overview Dashboard  
- Outcome-specific statistics
- Correlation tables (same-week vs lagged)
- Storm vs quiet week comparisons

### 3. Deep Dive Analysis
- Time series plots
- Scatter plots with trendlines
- Seasonal patterns
- Distribution comparisons

### 4. Interactive Explorer
- Custom date ranges
- User-defined storm thresholds  
- Filtered correlations
- Raw data access

### 5. Methodology Page
- Detailed methods
- Data source documentation
- Comprehensive limitations

---

## Technical Details

- **Weekly aggregation**: 3-hour geomagnetic data â†’ 388 MMWR weeks
- **Sample sizes**: ~23,000 geomagnetic measurements â†’ 388 weekly records
- **Correlations tested**: 20 total (4 outcomes Ã— 5 geomagnetic metrics)
- **Strongest correlations**: Stored for same-week, lag-1, and overall best
- **Visualization**: Plotly interactive charts with outcome-specific color coding

---

## Possible Biological Mechanisms

### Suicide (Positive Correlation)
**Circadian/melatonin pathway:**
- Geomagnetic activity â†’ melatonin suppression
- Disrupted sleep â†’ mood deterioration  
- Lagged effects (1 week) strengthen biological plausibility

### Violence (Negative Correlation)  
**Behavioral explanations:**
- Storms â†’ lethargy/fatigue â†’ reduced aggression
- Weather â†’ people stay indoors â†’ less interpersonal contact

### Cardiovascular (Negative Correlation)
**Weather confounding:**
- Storms correlate with cooler temperatures
- Reduced heat-related cardiac events
- Decreased physical exertion

### Overdose (No Correlation)
**Different drivers:**
- Primarily substance use disorder-driven
- Less sensitive to acute environmental changes

---

## References

1. Matzka, J., et al. (2021). The geomagnetic Kp index and derived planetary indices of geomagnetic activity. *Space Weather*, 19(5), e2020SW002641.  
   [https://doi.org/10.1029/2020SW002641](https://doi.org/10.1029/2020SW002641)

2. CDC WONDER. Provisional Mortality Statistics.  
   [https://wonder.cdc.gov/controller/datarequest/D176](https://wonder.cdc.gov/controller/datarequest/D176)

3. GFZ German Research Centre for Geosciences. Kp index data.  
   [https://kp.gfz.de/app/files/Kp_ap_since_1932.txt](https://kp.gfz.de/app/files/Kp_ap_since_1932.txt)

---

## License

- **CDC WONDER data**: Public domain
- **GFZ geomagnetic data**: CC BY 4.0
- **Code**: Available for research and educational purposes

---

## Contact

Lydia Zhigmitova 
lydiazhigmitova@gmail.com
---

**Last Updated:** December 2025
